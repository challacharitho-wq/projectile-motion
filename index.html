<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Projectile Motion Simulator – Judge Grade</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:system-ui,Segoe UI,Roboto,Arial;
  background:#f5f5f5;
  padding:2rem;
  color:#111;
}
.container{max-width:1500px;margin:auto}
.header{text-align:center;margin-bottom:1.5rem}
.header h1{font-size:1.9rem;font-weight:700}
.header p{color:#555;font-size:.9rem}

.grid{
  display:grid;
  grid-template-columns:360px 1fr 360px;
  gap:1.5rem;
}

.panel{
  background:#fff;
  border-radius:12px;
  padding:1.25rem;
  box-shadow:0 1px 4px rgba(0,0,0,.1);
}

h2{font-size:1.05rem;margin-bottom:1rem}

label{
  font-size:.8rem;
  color:#555;
  display:flex;
  justify-content:space-between;
  margin-bottom:.25rem;
}

input[type=range],select{width:100%}

button{
  width:100%;
  margin-top:.6rem;
  padding:.7rem;
  border:none;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
}

.launch{background:#22c55e;color:#fff}
.pause{background:#0f172a;color:#fff}
.compare{background:#334155;color:#fff}

canvas{
  width:100%;
  border:1px solid #e5e7eb;
  border-radius:8px;
  background:#fafafa;
}

.metric{
  background:#f9fafb;
  padding:.7rem;
  border-radius:8px;
  margin-bottom:.5rem;
  font-size:.85rem;
}
.metric span{font-weight:700}

.formula{
  background:#0f172a;
  color:#e5e7eb;
  padding:1rem;
  border-radius:10px;
  font-family:monospace;
  font-size:.82rem;
  margin-bottom:1rem;
}

.highlight{color:#22c55e;font-weight:700}
.note{font-size:.75rem;color:#64748b}
.tooltip{
  position:absolute;
  background:rgba(15,23,42,.95);
  color:#e5e7eb;
  font-family:monospace;
  font-size:11px;
  padding:6px 8px;
  border-radius:6px;
  pointer-events:none;
}
</style>
</head>

<body>
<div class="container">
  <div class="header">
    <h1>Projectile Motion Simulator</h1>
    <p>Interactive physics · Pause · Inspect · Compare</p>
  </div>

  <div class="grid">

    <!-- CONTROLS -->
    <div class="panel">
      <h2>Parameters</h2>

      <label>Angle <span id="aVal">45°</span></label>
      <input id="angle" type="range" min="0" max="90" value="45">

      <label>Velocity <span id="vVal">50 m/s</span></label>
      <input id="velocity" type="range" min="1" max="200" value="50">

      <label>Height <span id="hVal">0 m</span></label>
      <input id="height" type="range" min="0" max="50" value="0">

      <label>Gravity</label>
      <select id="gravity">
        <option value="9.81">Earth (9.81)</option>
        <option value="1.62">Moon (1.62)</option>
        <option value="3.71">Mars (3.71)</option>
      </select>

      <div class="note" id="gravityNote"></div>

      <button class="launch" onclick="start()">Launch</button>
      <button class="pause" onclick="togglePause()">Pause / Resume</button>
      <button class="compare" onclick="saveComparison()">Save for Comparison</button>
    </div>

    <!-- CANVAS -->
    <div class="panel" style="position:relative">
      <canvas id="canvas" width="900" height="520"></canvas>
      <div id="tooltip" class="tooltip" style="display:none"></div>
      <div class="note">Solid: current · Dashed: previous · Hover to inspect</div>
    </div>

    <!-- EDUCATION -->
    <div class="panel">
      <h2>Live Physics</h2>

      <div class="formula" id="formula"></div>

      <div class="metric">Stage: <span id="stage">–</span></div>
      <div class="metric">Max Height: <span id="maxH">0</span> m</div>
      <div class="metric">Range: <span id="range">0</span> m</div>
      <div class="metric">Time of Flight: <span id="tof">0</span> s</div>

      <div class="note">
        ✔ Time-based motion<br>
        ✔ Pause & probe states<br>
        ✔ Real scientific exploration
      </div>
    </div>

  </div>
</div>

<script>
const canvas=document.getElementById('canvas');
const ctx=canvas.getContext('2d');
const tooltip=document.getElementById('tooltip');

let trajectory=[],prevTrajectory=null;
let index=0,paused=false,anim=null;
const scale=3,offset=40,dt=0.05;

function start(){
  cancelAnimationFrame(anim);
  paused=false;index=0;trajectory=[];
  const a=+angle.value,v=+velocity.value,h=+height.value,g=+gravity.value;
  aVal.textContent=a+'°';vVal.textContent=v+' m/s';hVal.textContent=h+' m';

  const rad=a*Math.PI/180;
  const vx=v*Math.cos(rad),vy0=v*Math.sin(rad);

  let t=0,y=h;
  let maxH=h;

  while(y>=0){
    const x=vx*t;
    const vy=vy0-g*t;
    y=h+vy0*t-0.5*g*t*t;
    if(y>=0){
      trajectory.push({t,x,y,vy,v:Math.hypot(vx,vy)});
      if(y>maxH)maxH=y;
    }
    t+=dt;
  }

  updateFormula(v,a,g,trajectory.at(-1).x,maxH,t);
  animate();
}

function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawPath(prevTrajectory,true);
  drawPath(trajectory,false);

  if(!paused && index<trajectory.length-1) index++;
  const p=trajectory[index];
  drawBall(p);
  updateStage(p);

  anim=requestAnimationFrame(animate);
}

function drawPath(path,dashed){
  if(!path)return;
  ctx.setLineDash(dashed?[6,6]:[]);
  ctx.strokeStyle=dashed?'#94a3b8':'#22c55e';
  ctx.beginPath();
  path.forEach((p,i)=>{
    const X=p.x*scale+offset;
    const Y=canvas.height-(p.y*scale+offset);
    i?ctx.lineTo(X,Y):ctx.moveTo(X,Y);
  });
  ctx.stroke();
  ctx.setLineDash([]);
}

function drawBall(p){
  const X=p.x*scale+offset;
  const Y=canvas.height-(p.y*scale+offset);
  ctx.beginPath();
  ctx.arc(X,Y,8,0,Math.PI*2);
  ctx.fillStyle='#ef4444';
  ctx.fill();
}

function togglePause(){paused=!paused}
function saveComparison(){prevTrajectory=[...trajectory]}

function updateStage(p){
  let s='Descending';
  if(p.vy>0.2)s='Ascending';
  else if(Math.abs(p.vy)<0.2)s='At Apex';
  stage.textContent=s;
}

function updateFormula(v,a,g,R,H,T){
  formula.innerHTML=
`<span class="highlight">Range</span> = (v² sin 2θ) / g<br>
= (${v}² × sin ${2*a}°) / ${g}<br>
= <b>${R.toFixed(2)} m</b><br><br>
<span class="highlight">Max Height</span> = (v² sin²θ) / 2g<br>
= <b>${H.toFixed(2)} m</b><br><br>
<span class="highlight">Time of Flight</span> = 2v sinθ / g<br>
= <b>${T.toFixed(2)} s</b>`;

  maxH.textContent=H.toFixed(2);
  range.textContent=R.toFixed(2);
  tof.textContent=T.toFixed(2);

  gravityNote.textContent=g<5?
    'Lower gravity → longer flight & larger range':
    'Higher gravity → shorter flight';
}

canvas.addEventListener('mousemove',e=>{
  const rect=canvas.getBoundingClientRect();
  const mx=e.clientX-rect.left;
  let found=null;
  trajectory.forEach(p=>{
    const X=p.x*scale+offset;
    if(Math.abs(X-mx)<4)found=p;
  });
  if(found){
    tooltip.style.display='block';
    tooltip.style.left=e.pageX+10+'px';
    tooltip.style.top=e.pageY-10+'px';
    tooltip.innerHTML=
` t = ${found.t.toFixed(2)} s<br>
  x = ${found.x.toFixed(2)} m<br>
  y = ${found.y.toFixed(2)} m<br>
  |v| = ${found.v.toFixed(2)} m/s`;
  }else tooltip.style.display='none';
});
</script>
</body>
</html>
